<DivPad2>
    <LeftRightSection Style="@Style.MarginBottomPad1">
        <Right>
            <AddButton OnClick="AddPrivateSigning" />
        </Right>
    </LeftRightSection>
    <MudTable @ref="_table"
              Bordered="false"
              Dense="false"
              Hover="true"
              Items="Model.PrivateSignings"
              ServerData="@(new Func<TableState, Task<TableData<PromoterPrivateSigningModel>>>(OnRead))"
              Striped="true">
        <NoRecordsContent>
            <NoRecords Text="No Private Signings Found" />
        </NoRecordsContent>
        <ToolBarContent>
            <ToolbarTitle>My Private Signings</ToolbarTitle>
        </ToolBarContent>
        <HeaderContent>
            <MudTh></MudTh>
            <MudTh>Promotional Image</MudTh>
            <MudTh></MudTh>
            <MudTh>Person</MudTh>
            <MudTh>Submission Deadline Date</MudTh>
            <MudTh>Signing Date</MudTh>
            <MudTh>SASE Accepted</MudTh>
            <MudTh>Note</MudTh>
            <MudTh>Created On</MudTh>
            <MudTh></MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd>
                <ToggleGridButton Toggled="@(_ => ToggleChildContent(context.Id))"
                                  Visible="@(context.People.Length > 1)" />
            </MudTd>
            <MudTd>
                <GridImage ImageFileName="@context.PromoterImageFileName"
                           ImageLoaded="StateHasChanged"
                           Visible="@(!context.PromoterImageFileName.IsNullOrEmpty())" />
            </MudTd>
            <MudTd>
                <Condition Evaluation="context.People.Length == 1">
                    <Match>
                        <PersonGridImage ImageData="@(ImageService.GetPersonImageData(context.People.First().Person.ImageFileName))"
                                         ImageLoaded="StateHasChanged"
                                         PersonId="context.People.First().Person.Id" />
                    </Match>
                </Condition>                
            </MudTd>
            <MudTd DataLabel="Person">@(context.People.HasAny() ? (context.People.Length > 1 ? "Multiple People" : context.People.First().Person.DisplayName) : "No people added yet.")</MudTd>
            <MudTd DataLabel="SubmissionDeadlineDate">@(context.SubmissionDeadlineDate.ToString("MM-dd-yyyy"))</MudTd>
            <MudTd DataLabel="SigningDate">@(context.SigningDate.ToString("MM-dd-yyyy"))</MudTd>
            <MudTd DataLabel="SASEAccepted">@(context.SelfAddressedStampedEnvelopeAccepted ? "Yes" : "No")</MudTd>
            <MudTd DataLabel="Note">@context.Note</MudTd>
            <MudTd DataLabel="CreatedOn">@(context.CreatedDate.ToString("MM-dd-yyyy hh:mm:ss tt"))</MudTd>
            <MudTd>
                <EditGridButton OnEdit="@(_ => NavigationManager.NavigateTo($"{NavigationPath.MyPrivateSigningsEdit}/{DataProtectorService.EncryptId(context.Id)}"))"
                                Size="MudBlazor.Size.Small" />
            </MudTd>
        </RowTemplate>
        <ChildRowContent>
            <Condition Evaluation="@(context.People.HasAny() && context.People.Length > 1 && context.DisplayDetails)">
                <Match>
                    <tr />
                    <SummarySection>
                        <TableDataCentered>
                            Summary: Total Signers - <strong> @context.People.Length </strong>
                        </TableDataCentered>
                    </SummarySection>
                    <tr />
                    <TableRowPadded>
                        <TableDataSpan>
                            <MudTable Bordered="false"
                                    Dense="false"
                                    Hover="true"
                                    Items="context.People"
                                    Striped="true">
                                <ToolBarContent>
                                    <ToolbarTitle>People</ToolbarTitle>
                                    <MudSpacer />
                                </ToolBarContent>
                                <HeaderContent>
                                    <MudTh></MudTh>
                                    <MudTh></MudTh>
                                    <MudTh>Person</MudTh>
                                    <MudTh>Note</MudTh>
                                </HeaderContent>
                                <RowTemplate Context="privateSigningPerson">
                                    <MudTd>
                                        <GridImage ImageData="@(ImageService.GetUserImageData(privateSigningPerson.PromoterImageFileName, privateSigningPerson.CreatedUserId))"
                                                   ImageLoaded="StateHasChanged"
                                                   Visible="@(!privateSigningPerson.PromoterImageFileName.IsNullOrEmpty())" />
                                    </MudTd>
                                    <MudTd>
                                        <PersonGridImage ImageData="@(ImageService.GetPersonImageData(privateSigningPerson.Person.ImageFileName))"
                                                         ImageLoaded="StateHasChanged"
                                                         PersonId="privateSigningPerson.Person.Id" />
                                    </MudTd>
                                    <MudTd DataLabel="Person">@privateSigningPerson.Person.ProfileName</MudTd>
                                    <MudTd DataLabel="Note">@privateSigningPerson.Note</MudTd>
                                </RowTemplate>
                                <PagerContent>
                                    <MudTablePager />
                                </PagerContent>
                            </MudTable>
                        </TableDataSpan>
                    </TableRowPadded>
                </Match>
            </Condition>
        </ChildRowContent>
        <PagerContent>
            <MudTablePager />
        </PagerContent>
    </MudTable>
</DivPad2>


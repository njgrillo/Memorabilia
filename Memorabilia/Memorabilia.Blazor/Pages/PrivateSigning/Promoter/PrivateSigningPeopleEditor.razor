<DivRowFormGroup>
    <Div Class="col-4">
        <MudStack Row="true">
            <PersonDomainAutoComplete Disabled="@(EditMode == EditModeType.Update)"
                                      IsCulturalSearch="true"
                                      SelectedValue="EditModel.Person"
                                      SelectionChanged="(p) => EditModel.Person = p" />
            <Condition Evaluation="@(EditModel.Person.Id > 0)">
                <Match>
                    <MudTooltip Text="View Profile">
                        <MudIconButton Icon="@Icons.Material.Filled.Person"
                                       OnClick="ShowPersonProfile" />
                    </MudTooltip>
                </Match>
            </Condition>
        </MudStack>        
    </Div>
    <Div Class="col-3">
        <MudStack Row="true">
            <Condition Evaluation="EditModel.PromoterImageFileName.IsNullOrEmpty()">
                <Match>
                    <InputFile @bind-Value="@PromoterPrivateSigningPersonImage"
                               id="fileInputPromoterPersonImage"
                               accept="image/*" hidden
                               OnChange="@LoadFile" />
                    <MudFab for="fileInputPromoterPersonImage"
                            Color="MudBlazor.Color.Secondary"
                            HtmlTag="label"
                            Icon="@Icons.Material.Filled.Image"
                            Label="Load promotional image" />
                </Match>
            </Condition>
            <Condition Evaluation="@(!EditModel.PromoterImageFileName.IsNullOrEmpty())">
                <Match>
                    <MudImage Class="rounded-lg cant-click"
                              Elevation="5"
                              Height="70"
                              ObjectFit="@ObjectFit.Cover"
                              Src="@(ImageService.GetUserImageData(EditModel.PromoterImageFileName, ApplicationStateService.CurrentUser.Id))"
                              Width="70" />
                    <MudTooltip Text="Remove Image">
                        <MudFab Color="MudBlazor.Color.Secondary"
                                Icon="@Icons.Material.Outlined.Delete"
                                OnClick="RemovePromoterPersonImage"
                                Size="MudBlazor.Size.Small" />
                    </MudTooltip>
                </Match>
            </Condition>
            <AddUpdateMudFab EditMode="EditMode"
                             OnAdd="Add"
                             OnUpdate="Update" />
        </MudStack>        
    </Div>   
</DivRowFormGroup>
<DivRowFormGroup>
    <Div Class="col-3">
        <Switch Checked="@EditModel.AllowInscriptions"
                CheckedChanged="(p) => OnAllowInscriptionsChange(p)"
                Label="Inscriptions Allowed?" />
    </Div>
    <Condition Evaluation="@EditModel.AllowInscriptions">
        <Match>
            <Div Class="col-3">
                <NullableDecimalField Label="Inscription Cost"
                                      Value="EditModel.InscriptionCost"
                                      ValueChanged="@((p) => EditModel.InscriptionCost = p)" />
            </Div>            
        </Match>
    </Condition>
</DivRowFormGroup>
<DivRowFormGroup>
    <Div Class="col-3">
        <Switch Checked="LimitSpots"
                CheckedChanged="(p) => OnLimitSpotsChange(p)"
                Label="Limit Spots?" />
    </Div>
    <Condition Evaluation="LimitSpots">
        <Match>
            <Div Class="col-3">
                <NullableIntField Label="Spots Available"
                                  Value="EditModel.SpotsAvailable"
                                  ValueChanged="@((p) => EditModel.SpotsAvailable = p)" />
            </Div>            
            <Div Class="col-3">
                <NullableIntField Label="Spots Taken"
                                  Value="EditModel.SpotsConfirmed"
                                  ValueChanged="@((p) => EditModel.SpotsConfirmed = p)" />
            </Div>            
        </Match>
    </Condition>
</DivRowFormGroup>
<DivRowFormGroup>
    <MudStack Class="col-12"
              Row="true"
              Style="margin-bottom:1%;">
        <TextField Label="Note"
                   Lines="10"
                   SelectedText="@EditModel.Note"
                   SelectedTextChanged="@((p) => EditModel.Note = p)" />        
    </MudStack>
</DivRowFormGroup>
<MudTable Bordered="false"
          Dense="false"
          Hover="true"
          Items="@People.Where(person => !person.IsDeleted).ToList()"
          Striped="true">
    <ToolBarContent>
        <MudText Typo="Typo.h6">People</MudText>
    </ToolBarContent>
    <HeaderContent>
        <MudTh>Promotional Person Image</MudTh>
        <MudTh></MudTh>
        <MudTh>Name</MudTh>
        <MudTh>Inscriptions Allowed</MudTh>
        <MudTh>Inscription Cost</MudTh>
        <MudTh>Spots Available</MudTh>
        <MudTh>Spots Taken</MudTh>
        <MudTh>Note</MudTh>
        <MudTh></MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="">
            <Condition Evaluation="@(!context.PromoterImageFileName.IsNullOrEmpty())">
                <Match>
                    <GridImage AllowNavigation="false"
                               ImageLoaded="OnImageLoaded"
                               ImageFileName="@context.PromoterImageFileName" />
                </Match>
            </Condition>            
        </MudTd>
        <MudTd DataLabel="">
            <GridImage AllowNavigation="false" 
                       ImageLoaded="OnImageLoaded"
                       ImageFileName="@context.Person.ImageFileName"
                       IsPersonImage="true" />
        </MudTd>
        <MudTd DataLabel="Name">@context.Person.ProfileName</MudTd>
        <MudTd DataLabel="InscriptionsAllowed">@(context.AllowInscriptions ? "Yes" : "No")</MudTd>
        <MudTd DataLabel="InscriptionCost">@(context.AllowInscriptions ? context.InscriptionCost?.ToString("c") : "N/A")</MudTd>
        <MudTd DataLabel="SpotsAvailable">@(context.SpotsAvailable.HasValue ? context.SpotsAvailable.Value : "N/A")</MudTd>
        <MudTd DataLabel="SpotsConfirmed">@(context.SpotsConfirmed.HasValue ? context.SpotsConfirmed.Value : "N/A")</MudTd>
        <MudTd DataLabel="Note">@context.Note</MudTd>
        <MudTd DataLabel="">
            <MudTooltip Text="Edit">
                <MudFab Color="MudBlazor.Color.Primary"                                
                        Icon="@Icons.Material.Outlined.ModeEditOutline"
                        OnClick="@(_ => Edit(context))" />
            </MudTooltip> 
            <MudTooltip Text="Delete">
                <MudFab Color="MudBlazor.Color.Secondary"
                        Icon="@Icons.Material.Outlined.DeleteOutline"
                        OnClick="@(_ => context.IsDeleted = true)" />
            </MudTooltip> 
        </MudTd>
    </RowTemplate>
    <PagerContent>
        <MudTablePager />
    </PagerContent>
</MudTable>

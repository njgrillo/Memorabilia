<MudTable Bordered="false"
          Dense="false"
          Hover="true"
          Items="Items"
          Striped="true">
    <ToolBarContent>
        <ToolbarTitle Text="Proposed Trades" />
    </ToolBarContent>
    <HeaderContent>
        <MudTh></MudTh>
        <MudTh>Trade Partner</MudTh>
        <MudTh>Proposed Date</MudTh>
        <MudTh>Expires Date</MudTh>
        <MudTh>Amount to Receive</MudTh>
        <MudTh>Amount to Send</MudTh>
        <MudTh>Status</MudTh>
        <MudTh></MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd>
            <IconButton Icon="@context.ToggleIcon"
                        OnClick="@(_ => ToggleChildContent(context.Id))" />
        </MudTd>
        <MudTd DataLabel="TradePartnerName">@context.TradePartnerName</MudTd>
        <MudTd DataLabel="ProposedDate">@context.ProposedDate.ToString("MM-dd-yyyy")</MudTd>
        <MudTd DataLabel="ExpiresDate">@context.ExpirationDate.ToString("MM-dd-yyyy")</MudTd>
        <MudTd DataLabel="AmountToReceive">@(context.AmountToReceive?.ToString("c") ?? string.Empty)</MudTd>
        <MudTd DataLabel="AmountToSend">@(context.AmountToSend?.ToString("c") ?? string.Empty)</MudTd>
        <MudTd DataLabel="Status">@context.ProposeTradeStatusTypeName</MudTd>
        <TableData Visible="@context.CantAcceptCounterReject">
            <Fab Color="MudBlazor.Color.Secondary"
                 OnClick="@(_ => Cancel(context))"
                 StartIcon="@Icons.Material.Outlined.Cancel"
                 TooltipText="Cancel" />
        </TableData>
        <TableData Visible="@(!context.CantAcceptCounterReject && context.ShowActions)">
            <Fab Color="MudBlazor.Color.Secondary"
                 OnClick="@(_ => Accept(context))"
                 StartIcon="@Icons.Material.Outlined.Handshake"
                 TooltipText="Accept" />
            <Fab Color="MudBlazor.Color.Secondary"
                 OnClick="@(_ => Counter(context.Id))"
                 StartIcon="@Icons.Material.Outlined.SwapHoriz"
                 TooltipText="Counter" />
            <Fab Color="MudBlazor.Color.Secondary"
                 OnClick="@(_ => Reject(context))"
                 StartIcon="@Icons.Material.Outlined.DoNotTouch"
                 TooltipText="Reject" />
        </TableData>
    </RowTemplate>
    <ChildRowContent>
        <HiddenControl Visible="@context.DisplayTradeDetails">
            <tr />
            <SummarySection>
                <TableDataCentered>
                    Summary: Items Receiving - <strong> @context.ReceivingItemsCount </strong>, Items Sending - <strong> @context.SendingItemsCount </strong>
                </TableDataCentered>
            </SummarySection>
            <tr />
            <TableRowPadded>
                <TableDataSpan>
                    <MudTable Bordered="false"
                              Dense="false"
                              Hover="true"
                              Items="context.Memorabilia"
                              Striped="true">
                    <ToolBarContent>
                        <ToolbarTitle Text="Items" />
                        <MudSpacer />
                    </ToolBarContent>
                    <HeaderContent>
                        <MudTh></MudTh>
                        <MudTh>Item</MudTh>
                        <MudTh>Condition</MudTh>
                        <MudTh>Type</MudTh>
                        <MudTh></MudTh>
                    </HeaderContent>
                    <RowTemplate Context="item">
                        <MudTd DataLabel="">
                            <GridImage AllowNavigation="false" 
                                       ImageData="@(ImageService.GetUserImageData(item.Memorabilia.Images.FirstOrDefault(image => image.ImageTypeId == Constant.ImageType.Primary.Id).FileName, item.Memorabilia.UserId))"
                                       ImageLoaded="StateHasChanged" />
                        </MudTd>
                        <MudTd DataLabel="Item">@item.Memorabilia.ItemType.Name</MudTd>
                        <MudTd DataLabel="Condition">@item.Memorabilia.Condition.Name</MudTd>
                        <MudTd DataLabel="Type">
                            <Fab Color="MudBlazor.Color.Info"
                                 Size="MudBlazor.Size.Small"
                                 StartIcon="@(GetTypeIcon(item))"
                                 TooltipText="@GetProposeTradeMemorabiliaTypeName(item)" />
                        </MudTd>
                        <MudTd DataLabel="">
                            <ViewMemorabiliaImagesFab MemorabiliaId="item.Memorabilia.Id"
                                                      UserId="item.Memorabilia.UserId"
                                                      Visible="item.Memorabilia.Images.Any()"/>
                        </MudTd>
                    </RowTemplate>
                    <PagerContent>
                        <MudTablePager />
                    </PagerContent>
                </MudTable>
                </TableDataSpan>
            </TableRowPadded>
        </HiddenControl>
    </ChildRowContent>
    <PagerContent>
        <MudTablePager />
    </PagerContent>
</MudTable>
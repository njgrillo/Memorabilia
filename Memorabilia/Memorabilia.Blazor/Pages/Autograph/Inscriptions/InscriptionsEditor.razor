@inherits AutographItem<InscriptionEditModel>

<EditPage ContinueNavigationPath="@EditModel.ContinueNavigationPath"
          EditMode="EditModel.EditModeType"
          ExitNavigationPath="@EditModel.ExitNavigationPath"
          ImageFileName="@EditModel.ImageFileName"
          ItemName="@EditModel.PageTitle"
          Model="EditModel"
          OnLoad="OnLoad"
          OnSave="OnSave"
          PageFooterButtonText="@EditModel.ExitButtonText"
          PageFooterNavigationPath="@EditModel.BackNavigationPath"
          PageTitle="@EditModel.PageTitle"
          TItem="InscriptionsEditModel"
          UseMultipleButtons="true"
          ValidationResult="@Model.ValidationResult">
    <TimelineContent>
        <AutographTimeline AutographId="EditModel.AutographId" 
                           AutographStep="EditModel.AutographStep"  
                           DisplaySpot="EditModel.CanHaveSpot" 
                           EditMode="EditModel.EditModeType"
                           MemorabiliaId="EditModel.MemorabiliaId" />
    </TimelineContent>
    <ImagePreview>
        <Condition Evaluation="EditModel.HasMemorabiliaImages">
            <Match>
                <ImagePanel ImageNames="@EditModel.MemorabiliaImageNames"
                            PanelText="Memorabilia Images"
                            UserId="EditModel.UserId" />
            </Match>
        </Condition>
    </ImagePreview>
    <Content>
        <div class="d-flex justify-content-between" style="width:100%">
            <div style="width:48%">
                <DivRowCol6>
                    <Content>
                        <InscriptionTypeDropDown Disabled="@(!_canEditInscriptionType)"
                                                 SelectedValue="Model.InscriptionTypeId"
                                                 SelectionChanged="(p) => Model.InscriptionTypeId = p" />
                    </Content>
                </DivRowCol6>
                <DivRowCol6>
                    <Content>
                        <TextField Label="Inscription"
                                   SelectedText="@Model.InscriptionText"
                                   SelectedTextChanged="@((p) => Model.InscriptionText = p)" />
                    </Content>
                </DivRowCol6>
                <br/>
                <DivRowCol12>
                    <Content>
                        <DivLeftAlign>
                            <Content>
                                <DivHidden Hidden="@(!_canAddInscription)">
                                    <Content>
                                        <AddButton OnClick="AddInscription" />
                                    </Content>
                                </DivHidden>
                                <DivHidden Hidden="@(!_canUpdateInscription)">
                                    <Content>
                                        <UpdateButton OnClick="UpdateInscription" />
                                    </Content>
                                </DivHidden>
                            </Content>
                        </DivLeftAlign>
                    </Content>
                </DivRowCol12>
                <DivRowCol12>
                    <Content>
                        <MudTable Bordered="false"
                                  Dense="false"
                                  Hover="true"
                                  Items="@EditModel.Inscriptions.Where(inscription => !inscription.IsDeleted)"
                                  Striped="true">
                            <ToolBarContent>
                                <MudText Typo="Typo.h6">Inscriptions</MudText>
                            </ToolBarContent>
                            <HeaderContent>
                                <MudTh>Inscription Type</MudTh>
                                <MudTh>Inscription Text</MudTh>
                                <MudTh></MudTh>
                            </HeaderContent>
                            <RowTemplate Context="inscription">
                                <MudTd DataLabel="Inscription Type">@inscription.InscriptionTypeName</MudTd>
                                <MudTd DataLabel="Inscription Text">@inscription.InscriptionText</MudTd>
                                <MudTd DataLabel="">
                                    <MudTooltip Text="Edit">
                                        <MudFab Color="MudBlazor.Color.Primary"
                                                Icon="@Icons.Material.Outlined.ModeEditOutline"
                                                OnClick="@(_ => Edit(inscription))" />
                                    </MudTooltip>
                                    <MudTooltip Text="Delete">
                                        <MudFab Color="MudBlazor.Color.Secondary"
                                                Icon="@Icons.Material.Outlined.DeleteOutline"
                                                OnClick="@(_ => inscription.IsDeleted = true)" />
                                    </MudTooltip>
                                </MudTd>
                            </RowTemplate>
                        </MudTable>
                    </Content>
                </DivRowCol12>
                <br />
            </div>
            <div style="width:48%">
                <DivRowCol12>
                    <Content>
                        <SuggestedInscriptions InscriptionSelected="OnSuggestedInscriptionSelected"
                                               PersonId="EditModel.PersonId" />
                    </Content>
                </DivRowCol12>
            </div>
        </div>      
    </Content>
</EditPage>
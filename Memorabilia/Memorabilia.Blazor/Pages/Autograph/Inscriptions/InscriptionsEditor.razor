@inherits AutographItem<SaveInscriptionViewModel>

<EditPage ContinueNavigationPath="@_inscriptionsViewModel.ContinueNavigationPath"
          DomainImageRootPath="@DomainImageRootPath"
          EditMode="_inscriptionsViewModel.EditModeType"
          ExitNavigationPath="@_inscriptionsViewModel.ExitNavigationPath"
          ImageFileName="@_inscriptionsViewModel.ImageFileName"
          ItemName="@_inscriptionsViewModel.PageTitle"
          Model="_inscriptionsViewModel"
          OnLoad="OnLoad"
          OnSave="OnSave"
          PageFooterButtonText="@_inscriptionsViewModel.ExitButtonText"
          PageFooterNavigationPath="@_inscriptionsViewModel.BackNavigationPath"
          PageTitle="@_inscriptionsViewModel.PageTitle"
          TItem="SaveInscriptionsViewModel"
          UseMultipleButtons="true"
          ValidationResult="@ViewModel.ValidationResult">
    <TimelineContent>
        <AutographTimeline AutographId="_inscriptionsViewModel.AutographId" 
                           AutographStep="_inscriptionsViewModel.AutographStep"  
                           DisplaySpot="_inscriptionsViewModel.CanHaveSpot" 
                           EditMode="_inscriptionsViewModel.EditModeType"
                           MemorabiliaId="_inscriptionsViewModel.MemorabiliaId" />
    </TimelineContent>
    <ImagePreview>
        <PrettyBlazor.Condition Evaluation="_inscriptionsViewModel.HasMemorabiliaImages">
            <Match>
                <ImagePanel DomainImageRootPath="@DomainImageRootPath"
                            ImageNames="@_inscriptionsViewModel.MemorabiliaImageNames"
                            ImageRootPath="@UploadPath"
                            PanelText="Memorabilia Images" />
            </Match>
        </PrettyBlazor.Condition>
    </ImagePreview>
    <Content>
        <DivRowCol6>
            <Content>
                <SuggestedInscriptions InscriptionSelected="OnSuggestedInscriptionSelected"
                                       PersonId="_inscriptionsViewModel.PersonId" />
            </Content>
        </DivRowCol6>
        <DivRowCol4>
            <Content>
                <InscriptionTypeDropDown Disabled="@(!_canEditInscriptionType)" 
                                         SelectedValue="ViewModel.InscriptionTypeId"
                                         SelectionChanged="(p) => ViewModel.InscriptionTypeId = p" />
            </Content>
        </DivRowCol4>
        <DivRowCol4>
            <Content>
                <TextField Label="Inscription"
                           SelectedText="@ViewModel.InscriptionText"
                           SelectedTextChanged="@((p) => ViewModel.InscriptionText = p)" />
            </Content>
        </DivRowCol4>    
        <DivLeftAlign>
            <Content>
                <DivHidden Hidden="@(!_canAddInscription)">
                    <Content>
                        <AddButton OnClick="AddInscription" />
                    </Content>
                </DivHidden>
                <DivHidden Hidden="@(!_canUpdateInscription)">
                    <Content>
                        <UpdateButton OnClick="UpdateInscription" />
                    </Content>
                </DivHidden>
            </Content>
        </DivLeftAlign>
        <DivRowCol6>
            <Content>
                <MudTable Bordered="false"
                          Dense="false" 
                          Hover="true"
                          Items="@_inscriptionsViewModel.Inscriptions.Where(inscription => !inscription.IsDeleted)"    
                          Striped="true">
                    <ToolBarContent>
                        <MudText Typo="Typo.h6">Inscriptions</MudText>
                    </ToolBarContent>
                    <HeaderContent>
                        <MudTh>Inscription Type</MudTh>
                        <MudTh>Inscription Text</MudTh>
                        <MudTh></MudTh>
                    </HeaderContent>
                    <RowTemplate Context="inscription">
                        <MudTd DataLabel="Inscription Type">@inscription.InscriptionTypeName</MudTd>
                        <MudTd DataLabel="Inscription Text">@inscription.InscriptionText</MudTd>
                        <MudTd DataLabel="">
                            <MudTooltip Text="Edit">
                                <MudFab Color="MudBlazor.Color.Primary"                                
                                        Icon="@Icons.Outlined.ModeEditOutline"
                                        OnClick="@(_ => Edit(inscription))" />
                            </MudTooltip>    
                            <MudTooltip Text="Delete">
                                <MudFab Color="MudBlazor.Color.Secondary"
                                        Icon="@Icons.Outlined.DeleteOutline"
                                        OnClick="@(_ => inscription.IsDeleted = true)" />
                            </MudTooltip>
                        </MudTd>
                    </RowTemplate>
                </MudTable>
            </Content>
        </DivRowCol6>    
    </Content>
</EditPage>
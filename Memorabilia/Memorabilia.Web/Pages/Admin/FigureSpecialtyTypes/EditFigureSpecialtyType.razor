@page "/FigureSpecialtyTypes/Edit/{id:int}"

@using Memorabilia.Application.Features.Admin
@using Memorabilia.Application.Features.Admin.FigureSpecialtyType

@inject CommandRouter _commandRouter
@inject QueryRouter _queryRouter

<_EditDomainItem DomainItem="_viewModel"
                 OnLoad="OnLoad"
                 OnSave="OnSave" />

@code {
    [Parameter]
    public int Id { get; set; }

    private const string DomainTypeName = "Figure Speciality Type";
    private const string ImagePath = "images/figure.jpg";
    private string _navigationPath = $"{DomainTypeName.Replace(" ", "")}s";

    private SaveDomainViewModel _viewModel;  

    protected override void OnInitialized()
    {
        _viewModel = new SaveDomainViewModel(Id, DomainTypeName, ImagePath, _navigationPath);
    }   

    protected async Task OnLoad()
    {
        _viewModel = new SaveDomainViewModel(await _queryRouter.Send(new GetFigureSpecialtyType.Query(Id)).ConfigureAwait(false),
                                             DomainTypeName,
                                             ImagePath,
                                             _navigationPath);
    }

    protected async Task OnSave()
    {
        await _commandRouter.Send(new SaveFigureSpecialtyType.Command(_viewModel)).ConfigureAwait(false);
    }
}

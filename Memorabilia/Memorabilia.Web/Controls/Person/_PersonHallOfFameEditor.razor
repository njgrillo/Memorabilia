@using Memorabilia.Application.Features.Admin.Person
@using Memorabilia.Web.Controls.Franchise
@using Memorabilia.Web.Controls.LevelType
@using Memorabilia.Web.Controls.Sport

<div class="row">
    <div class="col-lg-12">
        <div class="form-group">
            <label for="sport">Sport</label>
            <_SportDropDown @bind-Value="@_viewModel.SportId"
                            @bind-Value:event="ValueChanged" /> 
        </div> 
    </div>
</div>
<div class="row">
    <div class="col-lg-12">
        <div class="form-group">
            <label for="levelType">Level</label>
            <_LevelTypeDropDown @bind-Value="@_viewModel.LevelTypeId"
                                @bind-Value:event="ValueChanged" /> 
        </div>
    </div>
</div>
<div class="row">
    <div class="col-lg-12">
        <div class="form-group">
            <label for="franchise">Franchise</label>
            <_FranchiseDropDown @bind-Value="@_viewModel.FranchiseId"
                                @bind-Value:event="ValueChanged" /> 
        </div>
    </div>
</div>
<div class="row">
    <div class="col-lg-6">
        <div class="form-group">
            <label for="inductionYear">Induction Year</label>
            <InputNumber class="form-control" @bind-Value="_viewModel.InductionYear" />
        </div>
    </div> 
    <div class="col-lg-6">
        <div class="form-group">
            <label for="voteCount">Vote Count</label>
            <InputNumber class="form-control" @bind-Value="_viewModel.VoteCount" />
        </div>
    </div> 
</div> 
<div class="text-right">
    <button type="button" class="btn btn-secondary" @onclick="Add">Add</button>
</div>
<br />
<table class="table" style="border: 1px solid black;">
    <thead>
        <tr>
            <th>Sport</th>
            <th>Level</th>
            <th>Franchise</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var hallOfFame in HallOfFames)
        {
            <tr>
                <td>@hallOfFame.SportName</td>
                <td>@hallOfFame.LevelTypeName</td>
                <td>@hallOfFame.FranchiseName</td>
                <td>
                    <_Tooltip Text="Delete">
                        <img class="can-click" 
                             src="images/trash.png" 
                             height="25" 
                             width="25" 
                             @onclick="@(_ => Remove(hallOfFame.SportId, hallOfFame.LevelTypeId))" />
                    </_Tooltip>
                </td>
            </tr>
        }
    </tbody>
</table>

@code {
    [Parameter]
    public List<SavePersonHallOfFameViewModel> HallOfFames { get; set; } = new();

    private SavePersonHallOfFameViewModel _viewModel = new SavePersonHallOfFameViewModel();

    private void Add()
    {        
        HallOfFames.Add(_viewModel);

        _viewModel = new SavePersonHallOfFameViewModel();
    }

    private void Remove(int sportId, int levelTypeId)
    {
        var hallOfFame = HallOfFames.SingleOrDefault(hallOfFame => hallOfFame.SportId == sportId && hallOfFame.LevelTypeId == levelTypeId);

        if (hallOfFame == null)
            return;

        HallOfFames.Remove(hallOfFame);                                                                               
    } 
}
